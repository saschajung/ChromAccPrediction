# Prediction of Chromatin Accessibility in Gene-Regulatory Regions from Transcriptomics Data
This repository contains a methodology for predicting binary chromatin accessibility (i.e. classifying genes as accessible or inaccessible) solely based on transcriptomics data, which is not dependent on the complex parameterizations needed by most current peak calling algorithms. Namely, our method predicts accessibility of genes based on a hierarchical classification tree model trained with datasets including experimentally derived gene expression and chromatin accessibility data. The approach is not limited to using solely gene expression data as an input but can be trained with an arbitrary number of user-defined predictor variables. The trained model can then be used to predict the binary chromatin accessibility for unseen datasets. In the following, we will describe the main functions for training the model and performing predictions.
## Training the hierarchical classification tree model
To train the model there exists one major function called **TrainAllClassifiers.m**. It accepts as input a cell array of matrices. Each matrix is of the form [Predictor1 Predictor2 ... PredictorN Observations] where PredictorI is a row vector of values that should be used for training and Observations is a row vector of binary accessibility assignments. For example, one predictor could be a vector of gene expression values and Observations is the binary accessibility assignment for these genes. The function calls the auxilliary functions **TrainL0Classifiers.m**, **TrainSingleL1Classifier.m**, **TrainSingleL2Classifier.m** and **CombinedLevel1Predictions.m**.

After the training is completed, the function returns all trained classifiers in different cell arrays for each level. It is to note that during the training process the classifiers are not compacted, i.e. they still contain the input training data. In case the function is called with many predictor variables and/or many different samples it might be advisable to compact them after training to save memory resources.
## Predicting unseen data with pre-trained model
For predicting the accessibility for new datasets there exists the function **MakeCombinedLevel2Predictions.m**. It takes the three cell arrays of trained classifiers and a matrix of the form [Predictor1 Predictor2 ... PredictorN] as inputs. The predictors have to be equivalent and in the same order as the ones used for training the model. Again, PredictorI is again a vector containing the values associated to the genes.

The function returns a vector **l** and a matrix **s**. The vector **l** contains the binary accessibility assignments for each gene in the same order as in the predictors and **s** provides the scores associated to each class. In particular, the first column of **s** corresponds to the score associated to inaccessible chromatin and the second column corresponds to the score associated to accessible chromatin. Importantly, these scores cannot be interpreted as probabilities and do not sum up to one. However, the higher the score the more certain the model classifies this gene.
